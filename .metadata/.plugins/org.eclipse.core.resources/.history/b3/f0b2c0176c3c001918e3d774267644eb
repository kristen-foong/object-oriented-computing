import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.*;
import javax.swing.border.TitledBorder;

public class StatPanel extends JPanel{
	private JTextArea text;
	private JTextField statNumWords, statAvgLength, statNumVowels;
	private JButton compute;
	
	public StatPanel() {

		setBackground(Color.LIGHT_GRAY);
		
		JPanel organizer = new JPanel();
		organizer.setLayout(new BorderLayout());
		
		addTextArea(organizer);
		addStatArea(organizer);
		
		compute = new JButton("Compute Statistics");
		compute.addActionListener(new TextListener());
		organizer.add(compute, BorderLayout.SOUTH);
		
		add(organizer);
		setPreferredSize(new Dimension(600,300));
	}
	
	public void addTextArea(JPanel organizer) {

		text = new JTextArea(10,20);
		JScrollPane scroll = new JScrollPane(text);
		scroll.setVerticalScrollBarPolicy(JScrollPane.VERTICAL_SCROLLBAR_ALWAYS);
		text.setEditable(true);
		text.setLineWrap(true);
		text.setBorder(BorderFactory.createLoweredBevelBorder());
		
		organizer.add(text, BorderLayout.WEST);
		organizer.add(scroll);
		
	}
	
	public void addStatArea(JPanel organizer) {
		
		JPanel statAreaContainer = new JPanel();
		
		JPanel statArea = new JPanel();
		statArea.setLayout(new GridLayout(3,2));
		TitledBorder statTitle = BorderFactory.createTitledBorder("Text Statistics");
		statTitle.setTitleJustification(TitledBorder.LEFT);
		statArea.setBorder(statTitle);
		
		JLabel numWords = new JLabel("Number of words:");
		statNumWords = new JTextField(25);
		JLabel avgLength = new JLabel("Average word length:");
		statAvgLength = new JTextField(25);
		JLabel numVowels = new JLabel("Number of vowels:");
		statNumVowels = new JTextField(25);
		
		statArea.add(numWords);
		statArea.add(statNumWords);
		statArea.add(avgLength);
		statArea.add(statAvgLength);
		statArea.add(numVowels);
		statArea.add(statNumVowels);
		
		statAreaContainer.add(statArea);
		statArea.setPreferredSize(new Dimension(300,100));
		organizer.add(statAreaContainer, BorderLayout.EAST);
	}
	
	private class TextListener implements ActionListener {
		public void actionPerformed(ActionEvent event) {
			String input = text.getText();
			
			int wordCount = getNumWords(input);
			statNumWords.setText("" + wordCount);
			
			double wordLengthAvg = getAvgLength(input);
			statAvgLength.setText("" + wordLengthAvg);
		}
		
		public int getNumWords(String words) {
			if(words.isEmpty()) {
				return 0;
			}
			
			String[] wordArr = words.split("\\w+");
			return wordArr.length;
		}
		
		public double getAvgLength(String input) {
			if(input.isEmpty()) {
				return 0;
			}
			String[] wordArr = input.split("\\w");
			double length = 0;
			for(String word : wordArr) {
				length += word.length();
			}
			return length;
		}
	}
}
