/**
 * The StatPanel class creates a panel that has a text area and statistics. Once
 * the button is pressed, the statistics are displayed in the text fields.
 * @auth Kristen Foong
 * @class CPSC1181
 * @lab Lab 7
 */


import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.*;
import javax.swing.border.TitledBorder;

public class StatPanel extends JPanel{
	private JTextArea text;
	private JTextField statNumWords, statAvgLength, statNumVowels;
	private JButton compute;
	
	public StatPanel() {

		setBackground(Color.LIGHT_GRAY);
		
		JPanel organizer = new JPanel();
		organizer.setLayout(new BorderLayout());
		
		addTextArea(organizer);
		addStatArea(organizer);
		
		compute = new JButton("Compute Statistics");
		compute.addActionListener(new TextListener());
		organizer.add(compute, BorderLayout.SOUTH);
		
		add(organizer);
		setPreferredSize(new Dimension(600,300));
	}
	
	public void addTextArea(JPanel organizer) {

		text = new JTextArea(10,20);
		JScrollPane scroll = new JScrollPane(text);
		scroll.setVerticalScrollBarPolicy(JScrollPane.VERTICAL_SCROLLBAR_ALWAYS);
		text.setEditable(true);
		text.setLineWrap(true);
		text.setBorder(BorderFactory.createLoweredBevelBorder());
		
		organizer.add(text, BorderLayout.WEST);
		organizer.add(scroll);
		
	}
	
	public void addStatArea(JPanel organizer) {
		
		JPanel statAreaContainer = new JPanel();
		
		JPanel statArea = new JPanel();
		statArea.setLayout(new GridLayout(3,2));
		TitledBorder statTitle = BorderFactory.createTitledBorder("Text Statistics");
		statTitle.setTitleJustification(TitledBorder.LEFT);
		statArea.setBorder(statTitle);
		
		JLabel numWords = new JLabel("Number of words:");
		statNumWords = new JTextField(25);
		JLabel avgLength = new JLabel("Average word length:");
		statAvgLength = new JTextField(25);
		JLabel numVowels = new JLabel("Number of vowels:");
		statNumVowels = new JTextField(25);
		
		statArea.add(numWords);
		statArea.add(statNumWords);
		statArea.add(avgLength);
		statArea.add(statAvgLength);
		statArea.add(numVowels);
		statArea.add(statNumVowels);
		
		statAreaContainer.add(statArea);
		statArea.setPreferredSize(new Dimension(300,100));
		organizer.add(statAreaContainer, BorderLayout.EAST);
	}
	
	private class TextListener implements ActionListener {
		public void actionPerformed(ActionEvent event) {
			String input = text.getText();
			
			int wordCount = getNumWords(input);
			statNumWords.setText("" + wordCount);
			
			double wordLengthAvg = getAvgLength(input, wordCount);
			statAvgLength.setText("" + wordLengthAvg);
			
			int totalVowels = getNumVowels(input);
			statNumVowels.setText("" + totalVowels);
		}
		
		public int getNumWords(String words) {
			if(words.isEmpty()) {
				return 0;
			}
			if(!words.contains(" ")) {
				return 1;
			}
			
			String[] wordArr = words.split("\\w+");
			return wordArr.length;
		}
		
		public double getAvgLength(String input, int wordCount) {
			if(input.isEmpty()) {
				return 0;
			}
			String[] wordArr = input.split(" ");
			double length = 0;
			for(String word : wordArr) {
				length += word.length();
			}
			return length / wordCount;
		}
		
		public int getNumVowels(String input) {
			if(input.isEmpty()) {
				return 0;
			}
			input.toLowerCase();
			int count = 0;
			for(int i = 0; i < input.length(); i++) {
				char curr = input.charAt(i);
				if(curr == 'a' || curr == 'e' || curr == 'i' || curr == 'o' || curr == 'u') {
					count++;
				}
			}
			return count;
		}
	}
}
